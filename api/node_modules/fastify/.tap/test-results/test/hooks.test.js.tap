TAP version 14
# Subtest: hooks
    1..49
    ok 1 - (unnamed test)
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - (unnamed test)
    ok 5 - should be equal
    ok 6 - should be equal
    ok 7 - (unnamed test)
    ok 8 - (unnamed test)
    ok 9 - (unnamed test)
    ok 10 - (unnamed test)
    ok 11 - (unnamed test)
    ok 12 - (unnamed test)
    ok 13 - should not error
    ok 14 - should be equal
    ok 15 - should be equal
    ok 16 - should be equal
    ok 17 - should be equal
    ok 18 - should be equal
    ok 19 - should be equal
    ok 20 - should be equal
    ok 21 - should be equal
    ok 22 - should be equal
    ok 23 - should be equal
    ok 24 - should be equal
    ok 25 - should be equal
    ok 26 - should be equal
    ok 27 - should be equal
    ok 28 - should be equal
    ok 29 - should not error
    ok 30 - should be equal
    ok 31 - should be equal
    ok 32 - should be equivalent
    ok 33 - should be equal
    ok 34 - should be equal
    ok 35 - should be equal
    ok 36 - should be equal
    ok 37 - should be equal
    ok 38 - should be equal
    ok 39 - should be equal
    ok 40 - should be equal
    ok 41 - should be equal
    ok 42 - should be equal
    ok 43 - should be equal
    ok 44 - should not error
    ok 45 - should be equal
    ok 46 - should be equal
    ok 47 - should be equal
    ok 48 - should not error
    ok 49 - should be equal
ok 1 - hooks # time=51.576ms

# Subtest: onRequest hook should support encapsulation / 1
    1..5
    ok 1 - should be equal
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should not error
    ok 5 - should be equal
ok 2 - onRequest hook should support encapsulation / 1 # time=7.922ms

# Subtest: onRequest hook should support encapsulation / 2
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
ok 3 - onRequest hook should support encapsulation / 2 # time=1.697ms

# Subtest: onRequest hook should support encapsulation / 3
    1..20
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should not error
    ok 7 - should be equal
    ok 8 - should be equal
    ok 9 - should be equivalent
    ok 10 - should be equal
    ok 11 - should be equal
    ok 12 - should be equal
    ok 13 - should be equal
    ok 14 - should be equal
    ok 15 - should be equal
    ok 16 - should be equal
    ok 17 - should not error
    ok 18 - should be equal
    ok 19 - should be equal
    ok 20 - should be equivalent
ok 4 - onRequest hook should support encapsulation / 3 # time=7.593ms

# Subtest: preHandler hook should support encapsulation / 5
    1..17
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should not error
    ok 6 - should be equal
    ok 7 - should be equal
    ok 8 - should be equivalent
    ok 9 - should be equal
    ok 10 - should be equal
    ok 11 - should be equal
    ok 12 - should be equal
    ok 13 - should be equal
    ok 14 - should not error
    ok 15 - should be equal
    ok 16 - should be equal
    ok 17 - should be equivalent
ok 5 - preHandler hook should support encapsulation / 5 # time=10.018ms

# Subtest: onRoute hook should be called / 1
    1..2
    ok 1 - (unnamed test)
    ok 2 - should not error
ok 6 - onRoute hook should be called / 1 # time=2.531ms

# Subtest: onRoute hook should be called / 2
    1..5
    ok 1 - (unnamed test)
    ok 2 - (unnamed test)
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should not error
ok 7 - onRoute hook should be called / 2 # time=1.728ms

# Subtest: onRoute hook should be called / 3
    1..5
    ok 1 - (unnamed test)
    ok 2 - (unnamed test)
    ok 3 - should not error
    ok 4 - (unnamed test)
    ok 5 - should not error
ok 8 - onRoute hook should be called / 3 # time=12.962ms

# Subtest: onRoute hook should be called (encapsulation support) / 4
    1..4
    ok 1 - (unnamed test)
    ok 2 - (unnamed test)
    ok 3 - (unnamed test)
    ok 4 - should not error
ok 9 - onRoute hook should be called (encapsulation support) / 4 # time=1.902ms

# Subtest: onRoute hook should be called (encapsulation support) / 5
    1..2
    ok 1 - (unnamed test)
    ok 2 - should not error
ok 10 - onRoute hook should be called (encapsulation support) / 5 # time=1.521ms

# Subtest: onRoute hook should be called (encapsulation support) / 6
    1..1
    ok 1 - should not error
ok 11 - onRoute hook should be called (encapsulation support) / 6 # time=0.928ms

# Subtest: onRoute should keep the context
    1..4
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should not error
ok 12 - onRoute should keep the context # time=1.465ms

# Subtest: onRoute hook should pass correct route
    1..9
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should be equal
    ok 7 - should be equal
    ok 8 - should be equal
    ok 9 - should not error
ok 13 - onRoute hook should pass correct route # time=1.56ms

# Subtest: onRoute hook should pass correct route with custom prefix
    1..11
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should be equal
    ok 7 - should be equal
    ok 8 - should be equal
    ok 9 - should be equal
    ok 10 - should be equal
    ok 11 - should not error
ok 14 - onRoute hook should pass correct route with custom prefix # time=3.435ms

# Subtest: onRoute hook should pass correct route with custom options
    1..6
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - type is function
    ok 6 - should not error
ok 15 - onRoute hook should pass correct route with custom options # time=1.783ms

# Subtest: onRoute hook should receive any route option
    1..5
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should not error
ok 16 - onRoute hook should receive any route option # time=1.389ms

# Subtest: onRoute hook should preserve system route configuration
    1..5
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should not error
ok 17 - onRoute hook should preserve system route configuration # time=1.677ms

# Subtest: onRoute hook should preserve handler function in options of shorthand route system configuration
    1..2
    ok 1 - should be equal
    ok 2 - should not error
ok 18 - onRoute hook should preserve handler function in options of shorthand route system configuration # time=1.933ms

# Subtest: onRoute hook should be called once when prefixTrailingSlash
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
ok 19 - onRoute hook should be called once when prefixTrailingSlash # time=1.808ms

# Subtest: onRoute hook should able to change the route url
    1..5
    ok 1 - should be equal
    ok 2 - should not error
    ok 3 - should not error
    ok 4 - should be equal
    ok 5 - should be equal
ok 20 - onRoute hook should able to change the route url # time=3.649ms

# Subtest: onRoute hook that throws should be caught
    1..1
    ok 1 - should be equal
ok 21 - onRoute hook that throws should be caught # time=1.266ms

# Subtest: onRoute hook with many prefix
    1..3
    ok 1 - should match pattern
    ok 2 - should match pattern
    ok 3 - should not error
ok 22 - onRoute hook with many prefix # time=2.275ms

# Subtest: onRoute hook should not be called when it registered after route
    1..3
    ok 1 - (unnamed test)
    ok 2 - (unnamed test)
    ok 3 - should not error
ok 23 - onRoute hook should not be called when it registered after route # time=1.037ms

# Subtest: onResponse hook should log request error
    1..4
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should not error
    ok 4 - should be equal
ok 24 - onResponse hook should log request error # time=3.519ms

# Subtest: onResponse hook should support encapsulation / 1
    1..5
    ok 1 - should be equal
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should not error
    ok 5 - should be equal
ok 25 - onResponse hook should support encapsulation / 1 # time=5.798ms

# Subtest: onResponse hook should support encapsulation / 2
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
ok 26 - onResponse hook should support encapsulation / 2 # time=2.181ms

# Subtest: onResponse hook should support encapsulation / 3
    1..16
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should not error
    ok 5 - should be equal
    ok 6 - should be equal
    ok 7 - should be equivalent
    ok 8 - should be equal
    ok 9 - should be equal
    ok 10 - should be equal
    ok 11 - should be equal
    ok 12 - should be equal
    ok 13 - should not error
    ok 14 - should be equal
    ok 15 - should be equal
    ok 16 - should be equivalent
ok 27 - onResponse hook should support encapsulation / 3 # time=5.201ms

# Subtest: onSend hook should support encapsulation / 1
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
ok 28 - onSend hook should support encapsulation / 1 # time=2.031ms

# Subtest: onSend hook should support encapsulation / 2
    1..16
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should not error
    ok 5 - should be equal
    ok 6 - should be equal
    ok 7 - should be equivalent
    ok 8 - should be equal
    ok 9 - should be equal
    ok 10 - should be equal
    ok 11 - should be equal
    ok 12 - should be equal
    ok 13 - should not error
    ok 14 - should be equal
    ok 15 - should be equal
    ok 16 - should be equivalent
ok 29 - onSend hook should support encapsulation / 2 # time=4.509ms

# Subtest: onSend hook is called after payload is serialized and headers are set
    1..30
    ok 1 - should be equivalent
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should be equal
    ok 7 - should be equal
    ok 8 - should be equal
    ok 9 - should be equal
    ok 10 - should be equal
    ok 11 - should not error
    ok 12 - should be equal
    ok 13 - should be equivalent
    ok 14 - should be equal
    ok 15 - should not error
    ok 16 - should be equal
    ok 17 - should be equivalent
    ok 18 - should be equal
    ok 19 - should not error
    ok 20 - should be equal
    ok 21 - should be equivalent
    ok 22 - should be equal
    ok 23 - should not error
    ok 24 - should be equal
    ok 25 - should be equivalent
    ok 26 - should be equal
    ok 27 - should not error
    ok 28 - should be equal
    ok 29 - should be equivalent
    ok 30 - should be equal
ok 30 - onSend hook is called after payload is serialized and headers are set # time=6.03ms

# Subtest: modify payload
    1..10
    ok 1 - should be equal
    ok 2 - should be equivalent
    ok 3 - should be equal
    ok 4 - should be equivalent
    ok 5 - should be equal
    ok 6 - should be equal
    ok 7 - should not error
    ok 8 - should be equal
    ok 9 - should be equal
    ok 10 - should be equal
ok 31 - modify payload # time=1.979ms

# Subtest: clear payload
    1..6
    ok 1 - should be equal
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should be equal
ok 32 - clear payload # time=2.742ms

# Subtest: onSend hook throws
    1..11
    ok 1 - should not error
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equivalent
    ok 6 - should not error
    ok 7 - should be equal
    ok 8 - should not error
    ok 9 - should be equal
    ok 10 - should not error
    ok 11 - should be equal
ok 33 - onSend hook throws # time=17.758ms

# Subtest: onSend hook should receive valid request and reply objects if onRequest hook fails
    1..4
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should not error
    ok 4 - should be equal
ok 34 - onSend hook should receive valid request and reply objects if onRequest hook fails # time=1.945ms

# Subtest: onSend hook should receive valid request and reply objects if a custom content type parser fails
    1..4
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should not error
    ok 4 - should be equal
ok 35 - onSend hook should receive valid request and reply objects if a custom content type parser fails # time=1.748ms

# Subtest: Content-Length header should be updated if onSend hook modifies the payload
    1..2
    ok 1 - should not error
    ok 2 - should be equal
ok 36 - Content-Length header should be updated if onSend hook modifies the payload # time=1.161ms

# Subtest: cannot add hook after binding
    1..2
    ok 1 - should not error
    ok 2 - (unnamed test)
ok 37 - cannot add hook after binding # time=4.413ms

# Subtest: onRequest hooks should be able to block a request
    1..5
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should not error
    ok 4 - should be equal
    ok 5 - should be equal
ok 38 - onRequest hooks should be able to block a request # time=1.383ms

# Subtest: preValidation hooks should be able to block a request
    1..5
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should not error
    ok 4 - should be equal
    ok 5 - should be equal
ok 39 - preValidation hooks should be able to block a request # time=1.249ms

# Subtest: preValidation hooks should be able to change request body before validation
    1..4
    ok 1 - (unnamed test)
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should be equal
ok 40 - preValidation hooks should be able to change request body before validation # time=21.124ms

# Subtest: preParsing hooks should be able to block a request
    1..5
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should not error
    ok 4 - should be equal
    ok 5 - should be equal
ok 41 - preParsing hooks should be able to block a request # time=1.358ms

# Subtest: preHandler hooks should be able to block a request
    1..5
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should not error
    ok 4 - should be equal
    ok 5 - should be equal
ok 42 - preHandler hooks should be able to block a request # time=1.152ms

# Subtest: onRequest hooks should be able to block a request (last hook)
    1..5
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should not error
    ok 4 - should be equal
    ok 5 - should be equal
ok 43 - onRequest hooks should be able to block a request (last hook) # time=1.093ms

# Subtest: preHandler hooks should be able to block a request (last hook)
    1..5
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should not error
    ok 4 - should be equal
    ok 5 - should be equal
ok 44 - preHandler hooks should be able to block a request (last hook) # time=0.966ms

# Subtest: preParsing hooks should handle errors
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equivalent
ok 45 - preParsing hooks should handle errors # time=1.072ms

# Subtest: onRequest respond with a stream
    1..4
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should not error
    ok 4 - should be equal
ok 46 - onRequest respond with a stream # time=2.743ms

# Subtest: preHandler respond with a stream
    1..7
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should not error
    ok 7 - should be equal
ok 47 - preHandler respond with a stream # time=4.172ms

# Subtest: Register an hook after a plugin inside a plugin
    1..6
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should not error
    ok 5 - should be equal
    ok 6 - should be equivalent
ok 48 - Register an hook after a plugin inside a plugin # time=1.954ms

# Subtest: Register an hook after a plugin inside a plugin (with preHandler option)
    1..7
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should not error
    ok 6 - should be equal
    ok 7 - should be equivalent
ok 49 - Register an hook after a plugin inside a plugin (with preHandler option) # time=1.51ms

# Subtest: Register hooks inside a plugin after an encapsulated plugin
    1..7
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should not error
    ok 6 - should be equal
    ok 7 - should be equivalent
ok 50 - Register hooks inside a plugin after an encapsulated plugin # time=1.759ms

# Subtest: onRequest hooks should run in the order in which they are defined
    1..9
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should be equal
    ok 7 - should not error
    ok 8 - should be equal
    ok 9 - should be equivalent
ok 51 - onRequest hooks should run in the order in which they are defined # time=6.393ms

# Subtest: preHandler hooks should run in the order in which they are defined
    1..9
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should be equal
    ok 7 - should not error
    ok 8 - should be equal
    ok 9 - should be equivalent
ok 52 - preHandler hooks should run in the order in which they are defined # time=2.383ms

# Subtest: onSend hooks should run in the order in which they are defined
    1..8
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should not error
    ok 7 - should be equal
    ok 8 - should be equivalent
ok 53 - onSend hooks should run in the order in which they are defined # time=1.942ms

# Subtest: onResponse hooks should run in the order in which they are defined
    1..8
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should not error
    ok 7 - should be equal
    ok 8 - should be equivalent
ok 54 - onResponse hooks should run in the order in which they are defined # time=1.835ms

# Subtest: onRequest, preHandler, and onResponse hooks that resolve to a value do not cause an error
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
ok 55 - onRequest, preHandler, and onResponse hooks that resolve to a value do not cause an error # time=1.678ms

# Subtest: If a response header has been set inside an hook it should not be overwritten by the final response handler
    1..5
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
ok 56 - If a response header has been set inside an hook it should not be overwritten by the final response handler # time=5.95ms

# Subtest: If the content type has been set inside an hook it should not be changed
    1..5
    ok 1 - should be equal
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
ok 57 - If the content type has been set inside an hook it should not be changed # time=1.092ms

# Subtest: request in onRequest, preParsing, preValidation and onResponse
    1..18
    ok 1 - should be equivalent
    ok 2 - should be equivalent
    ok 3 - should be equivalent
    ok 4 - should be equivalent
    ok 5 - should be equivalent
    ok 6 - should be equivalent
    ok 7 - should be equivalent
    ok 8 - should be equivalent
    ok 9 - should be equivalent
    ok 10 - should be equivalent
    ok 11 - should be equivalent
    ok 12 - should be equivalent
    ok 13 - should be equivalent
    ok 14 - should be equivalent
    ok 15 - should be equivalent
    ok 16 - should be equivalent
    ok 17 - should not error
    ok 18 - should be equal
ok 58 - request in onRequest, preParsing, preValidation and onResponse # time=2.573ms

# Subtest: preValidation hook should support encapsulation / 1
    1..5
    ok 1 - should be equal
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should not error
    ok 5 - should be equal
ok 59 - preValidation hook should support encapsulation / 1 # time=1.595ms

# Subtest: preValidation hook should support encapsulation / 2
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
ok 60 - preValidation hook should support encapsulation / 2 # time=1.053ms

# Subtest: preValidation hook should support encapsulation / 3
    1..20
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should not error
    ok 7 - should be equal
    ok 8 - should be equal
    ok 9 - should be equivalent
    ok 10 - should be equal
    ok 11 - should be equal
    ok 12 - should be equal
    ok 13 - should be equal
    ok 14 - should be equal
    ok 15 - should be equal
    ok 16 - should be equal
    ok 17 - should not error
    ok 18 - should be equal
    ok 19 - should be equal
    ok 20 - should be equivalent
ok 61 - preValidation hook should support encapsulation / 3 # time=6.306ms

# Subtest: onError hook
    1..3
    ok 1 - should match pattern
    ok 2 - should not error
    ok 3 - should be equivalent
ok 62 - onError hook # time=1.454ms

# Subtest: reply.send should throw if called inside the onError hook
    1..3
    ok 1 - should be equal
    ok 2 - should not error
    ok 3 - should be equivalent
ok 63 - reply.send should throw if called inside the onError hook # time=1.199ms

# Subtest: onError hook with setErrorHandler
    # Subtest: Send error
        1..3
        ok 1 - should match pattern
        ok 2 - should not error
        ok 3 - should be equivalent
    ok 1 - Send error # time=1.296ms
    
    1..1
ok 64 - onError hook with setErrorHandler # time=4.751ms

# Subtest: preParsing hook should run before parsing and be able to modify the payload
    1..5
    ok 1 - should not error
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equivalent
ok 65 - preParsing hook should run before parsing and be able to modify the payload # time=7.549ms

# Subtest: preParsing hooks should run in the order in which they are defined
    1..5
    ok 1 - should not error
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equivalent
ok 66 - preParsing hooks should run in the order in which they are defined # time=7.407ms

# Subtest: preParsing hooks should support encapsulation
    1..9
    ok 1 - should not error
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equivalent
    ok 6 - should not error
    ok 7 - should be equal
    ok 8 - should be equal
    ok 9 - should be equivalent
ok 67 - preParsing hooks should support encapsulation # time=4.82ms

# Subtest: preParsing hook should support encapsulation / 1
    1..5
    ok 1 - should be equal
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should not error
    ok 5 - should be equal
ok 68 - preParsing hook should support encapsulation / 1 # time=3.061ms

# Subtest: preParsing hook should support encapsulation / 2
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
ok 69 - preParsing hook should support encapsulation / 2 # time=1.539ms

# Subtest: preParsing hook should support encapsulation / 3
    1..20
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should not error
    ok 7 - should be equal
    ok 8 - should be equal
    ok 9 - should be equivalent
    ok 10 - should be equal
    ok 11 - should be equal
    ok 12 - should be equal
    ok 13 - should be equal
    ok 14 - should be equal
    ok 15 - should be equal
    ok 16 - should be equal
    ok 17 - should not error
    ok 18 - should be equal
    ok 19 - should be equal
    ok 20 - should be equivalent
ok 70 - preParsing hook should support encapsulation / 3 # time=5.015ms

# Subtest: preSerialization hook should run before serialization and be able to modify the payload
    1..5
    ok 1 - should not error
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equivalent
ok 71 - preSerialization hook should run before serialization and be able to modify the payload # time=5.291ms

# Subtest: preSerialization hook should be able to throw errors which are validated against schema response
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should not error
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should be equivalent
    1..6
ok 72 - preSerialization hook should be able to throw errors which are validated against schema response # time=4.471ms

# Subtest: preSerialization hook which returned error should still run onError hooks
    1..4
    ok 1 - should not error
    ok 2 - (unnamed test)
    ok 3 - should not error
    ok 4 - should be equal
ok 73 - preSerialization hook which returned error should still run onError hooks # time=2.794ms

# Subtest: preSerialization hooks should run in the order in which they are defined
    1..5
    ok 1 - should not error
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equivalent
ok 74 - preSerialization hooks should run in the order in which they are defined # time=3.816ms

# Subtest: preSerialization hooks should support encapsulation
    1..9
    ok 1 - should not error
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equivalent
    ok 6 - should not error
    ok 7 - should be equal
    ok 8 - should be equal
    ok 9 - should be equivalent
ok 75 - preSerialization hooks should support encapsulation # time=5.155ms

# Subtest: onRegister hook should be called / 1
    1..3
    ok 1 - should be equal
    ok 2 - should be equivalent
    ok 3 - should not error
ok 76 - onRegister hook should be called / 1 # time=1.263ms

# Subtest: onRegister hook should be called / 2
    1..4
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should not error
ok 77 - onRegister hook should be called / 2 # time=1.205ms

# Subtest: onRegister hook should be called / 3
    1..4
    ok 1 - should be equivalent
    ok 2 - should be equivalent
    ok 3 - should be equivalent
    ok 4 - should not error
ok 78 - onRegister hook should be called / 3 # time=1.481ms

# Subtest: onRegister hook should be called (encapsulation)
    1..1
    ok 1 - should not error
ok 79 - onRegister hook should be called (encapsulation) # time=0.806ms

# Subtest: early termination, onRequest
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
ok 80 - early termination, onRequest # time=1.007ms

# Subtest: reply.send should throw if undefined error is thrown
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equivalent
ok 81 - reply.send should throw if undefined error is thrown # time=1.195ms

# Subtest: reply.send should throw if undefined error is thrown at preParsing hook
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equivalent
ok 82 - reply.send should throw if undefined error is thrown at preParsing hook # time=0.967ms

# Subtest: reply.send should throw if undefined error is thrown at onSend hook
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equivalent
ok 83 - reply.send should throw if undefined error is thrown at onSend hook # time=0.954ms

# Subtest: onTimeout should be triggered
    1..6
    ok 1 - should not error
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - onTimeout
    ok 5 - type is Error
    ok 6 - should be equal
ok 84 - onTimeout should be triggered # time=511.14ms

# Subtest: onTimeout should be triggered and socket _meta is set
    1..6
    ok 1 - should not error
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - onTimeout
    ok 5 - type is Error
    ok 6 - should be equal
ok 85 - onTimeout should be triggered and socket _meta is set # time=506.639ms

# Subtest: registering invalid hooks should throw an error
    1..3
    ok 1 - expected to throw
    ok 2 - expected to throw
    ok 3 - expected to throw
ok 86 - registering invalid hooks should throw an error # time=1.224ms

# Subtest: onRequestAbort should be triggered
    1..7
    ok 1 - should not error
    ok 2 - handler called
    ok 3 - called in hook
    ok 4 - request has pendingResolve
    ok 5 - called in route
    ok 6 - handler promise resolved
    ok 7 - onSend should be called
ok 87 - onRequestAbort should be triggered # time=504.395ms

# Subtest: onRequestAbort should support encapsulation
    1..6
    ok 1 - should not error
    ok 2 - called in root
    ok 3 - should be equivalent strictly
    ok 4 - called in child
    ok 5 - should be equivalent strictly
    ok 6 - called in route
ok 88 - onRequestAbort should support encapsulation # time=504.635ms

# Subtest: onRequestAbort should handle errors / 1
    1..2
    ok 1 - should not error
    ok 2 - (unnamed test)
ok 89 - onRequestAbort should handle errors / 1 # time=505.088ms

# Subtest: onRequestAbort should handle errors / 2
    1..2
    ok 1 - should not error
    ok 2 - (unnamed test)
ok 90 - onRequestAbort should handle errors / 2 # time=503.894ms

# Subtest: onRequestAbort should handle async errors / 1
    1..2
    ok 1 - should not error
    ok 2 - (unnamed test)
ok 91 - onRequestAbort should handle async errors / 1 # time=506.332ms

# Subtest: onRequestAbort should handle async errors / 2
    1..2
    ok 1 - should not error
    ok 2 - (unnamed test)
ok 92 - onRequestAbort should handle async errors / 2 # time=504.655ms

1..92
