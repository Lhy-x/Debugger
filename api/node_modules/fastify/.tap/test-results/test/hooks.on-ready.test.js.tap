TAP version 14
# Subtest: onReady should be called in order
    1..7
    ok 1 - called in root
    ok 2 - the this binding is the right instance
    ok 3 - called in childOne
    ok 4 - the this binding is the right instance
    ok 5 - called in childTwo
    ok 6 - the this binding is the right instance
    ok 7 - should not error
ok 1 - onReady should be called in order # time=16.524ms

# Subtest: onReady should be called once
    ok 1 - Should resolve in order
    ok 2 - Should call onReady only once
    1..2
ok 2 - onReady should be called once # time=1.974ms

# Subtest: async onReady should be called in order
    1..7
    ok 1 - called in root
    ok 2 - the this binding is the right instance
    ok 3 - called in childOne
    ok 4 - the this binding is the right instance
    ok 5 - called in childTwo
    ok 6 - the this binding is the right instance
    ok 7 - ready
ok 3 - async onReady should be called in order # time=5.576ms

# Subtest: mix ready and onReady
    1..2
    ok 1 - should be equal
    ok 2 - ready hooks execute once
ok 4 - mix ready and onReady # time=1.859ms

# Subtest: listen and onReady order
    1..9
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should be equal
    ok 7 - should be equal
    ok 8 - trigger the onReady
    ok 9 - do not trigger the onReady
ok 5 - listen and onReady order # time=19.917ms

# Subtest: multiple ready calls
    1..11
    ok 1 - ready and hooks not triggered yet
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should be equal
    ok 7 - should be equal
    ok 8 - should be equal
    ok 9 - trigger the onReady
    ok 10 - do not trigger the onReady
    ok 11 - do not trigger the onReady
ok 6 - multiple ready calls # time=2.561ms

# Subtest: onReady should manage error in sync
    1..4
    ok 1 - called in root
    ok 2 - called in childOne
    ok 3 - should be equal
    ok 4 - should be equal
ok 7 - onReady should manage error in sync # time=3.022ms

# Subtest: onReady should manage error in async
    1..4
    ok 1 - called in root
    ok 2 - called in childOne
    ok 3 - should be equal
    ok 4 - should be equal
ok 8 - onReady should manage error in async # time=2.027ms

# Subtest: onReady should manage sync error
    1..4
    ok 1 - called in root
    ok 2 - called in childOne
    ok 3 - should be equal
    ok 4 - should be equal
ok 9 - onReady should manage sync error # time=1.636ms

# Subtest: onReady can not add decorators or application hooks
    1..3
    ok 1 - called in root
    ok 2 - should be equal
    ok 3 - should not error
ok 10 - onReady can not add decorators or application hooks # time=1.18ms

# Subtest: onReady cannot add lifecycle hooks
    1..5
    ok 1 - called in root
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
ok 11 - onReady cannot add lifecycle hooks # time=2.477ms

# Subtest: onReady throw loading error
    1..2
    ok 1 - FST_ERR_HOOK_INVALID_ASYNC_HANDLER
    ok 2 - should be equal
ok 12 - onReady throw loading error # time=0.49ms

# Subtest: onReady does not call done
    1..6
    ok 1 - called in root
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should be equal
ok 13 - onReady does not call done # time=502.306ms

# Subtest: onReady execution order
    1..3
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equal
ok 14 - onReady execution order # time=1.236ms

# Subtest: ready return the server with callback
    1..2
    ok 1 - should not error
    ok 2 - should be equivalent
ok 15 - ready return the server with callback # time=1.487ms

# Subtest: ready return the server with Promise
    1..1
    ok 1 - should be equivalent
ok 16 - ready return the server with Promise # time=1.203ms

# Subtest: ready return registered
    1..4
    ok 1 - should be equivalent
    ok 2 - should be equivalent
    ok 3 - should be equivalent
    ok 4 - should be equivalent
ok 17 - ready return registered # time=2.403ms

# Subtest: do not crash with error in follow up onReady hook
    ok 1 - expected to reject
    1..1
ok 18 - do not crash with error in follow up onReady hook # time=4.649ms

1..18
