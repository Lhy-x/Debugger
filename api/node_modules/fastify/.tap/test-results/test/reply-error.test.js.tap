TAP version 14
# Subtest: Reply error handling - code: 400
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 1 - Reply error handling - code: 400 # time=38.419ms

# Subtest: Reply error handling - code: 401
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 2 - Reply error handling - code: 401 # time=1.865ms

# Subtest: Reply error handling - code: 402
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 3 - Reply error handling - code: 402 # time=3.03ms

# Subtest: Reply error handling - code: 403
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 4 - Reply error handling - code: 403 # time=4.064ms

# Subtest: Reply error handling - code: 404
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 5 - Reply error handling - code: 404 # time=3.801ms

# Subtest: Reply error handling - code: 405
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 6 - Reply error handling - code: 405 # time=1.538ms

# Subtest: Reply error handling - code: 406
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 7 - Reply error handling - code: 406 # time=2.463ms

# Subtest: Reply error handling - code: 407
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 8 - Reply error handling - code: 407 # time=1.34ms

# Subtest: Reply error handling - code: 408
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 9 - Reply error handling - code: 408 # time=1.389ms

# Subtest: Reply error handling - code: 409
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 10 - Reply error handling - code: 409 # time=1.432ms

# Subtest: Reply error handling - code: 410
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 11 - Reply error handling - code: 410 # time=1.497ms

# Subtest: Reply error handling - code: 411
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 12 - Reply error handling - code: 411 # time=1.335ms

# Subtest: Reply error handling - code: 412
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 13 - Reply error handling - code: 412 # time=1.436ms

# Subtest: Reply error handling - code: 413
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 14 - Reply error handling - code: 413 # time=1.32ms

# Subtest: Reply error handling - code: 414
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 15 - Reply error handling - code: 414 # time=5.497ms

# Subtest: Reply error handling - code: 415
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 16 - Reply error handling - code: 415 # time=2.556ms

# Subtest: Reply error handling - code: 416
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 17 - Reply error handling - code: 416 # time=1.723ms

# Subtest: Reply error handling - code: 417
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 18 - Reply error handling - code: 417 # time=1.92ms

# Subtest: Reply error handling - code: 418
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 19 - Reply error handling - code: 418 # time=1.367ms

# Subtest: Reply error handling - code: 421
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 20 - Reply error handling - code: 421 # time=2.495ms

# Subtest: Reply error handling - code: 422
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 21 - Reply error handling - code: 422 # time=1.354ms

# Subtest: Reply error handling - code: 423
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 22 - Reply error handling - code: 423 # time=1.433ms

# Subtest: Reply error handling - code: 424
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 23 - Reply error handling - code: 424 # time=1.32ms

# Subtest: Reply error handling - code: 425
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 24 - Reply error handling - code: 425 # time=1.23ms

# Subtest: Reply error handling - code: 426
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 25 - Reply error handling - code: 426 # time=1.227ms

# Subtest: Reply error handling - code: 428
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 26 - Reply error handling - code: 428 # time=1.181ms

# Subtest: Reply error handling - code: 429
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 27 - Reply error handling - code: 429 # time=2.896ms

# Subtest: Reply error handling - code: 431
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 28 - Reply error handling - code: 431 # time=1.346ms

# Subtest: Reply error handling - code: 451
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 29 - Reply error handling - code: 451 # time=1.387ms

# Subtest: Reply error handling - code: 500
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 30 - Reply error handling - code: 500 # time=1.358ms

# Subtest: Reply error handling - code: 501
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 31 - Reply error handling - code: 501 # time=1.254ms

# Subtest: Reply error handling - code: 502
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 32 - Reply error handling - code: 502 # time=1.266ms

# Subtest: Reply error handling - code: 503
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 33 - Reply error handling - code: 503 # time=7.772ms

# Subtest: Reply error handling - code: 504
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 34 - Reply error handling - code: 504 # time=1.811ms

# Subtest: Reply error handling - code: 505
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 35 - Reply error handling - code: 505 # time=1.23ms

# Subtest: Reply error handling - code: 506
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 36 - Reply error handling - code: 506 # time=1.192ms

# Subtest: Reply error handling - code: 507
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 37 - Reply error handling - code: 507 # time=1.173ms

# Subtest: Reply error handling - code: 508
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 38 - Reply error handling - code: 508 # time=1.216ms

# Subtest: Reply error handling - code: 509
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 39 - Reply error handling - code: 509 # time=1.202ms

# Subtest: Reply error handling - code: 510
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 40 - Reply error handling - code: 510 # time=1.118ms

# Subtest: Reply error handling - code: 511
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 41 - Reply error handling - code: 511 # time=1.081ms

# Subtest: preHandler hook error handling with external code
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equivalent
ok 42 - preHandler hook error handling with external code # time=4.281ms

# Subtest: onRequest hook error handling with external done
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equivalent
ok 43 - onRequest hook error handling with external done # time=1.319ms

# Subtest: Should reply 400 on client error
    1..2
    ok 1 - should not error
    ok 2 - should be equal
ok 44 - Should reply 400 on client error # time=7.521ms

# Subtest: Should set the response from client error handler
    1..5
    ok 1 - should not error
    ok 2 - type is Error
    ok 3 - should be equal
    ok 4 - Log level is not warn
    ok 5 - should be equal
ok 45 - Should set the response from client error handler # time=5.081ms

# Subtest: Error instance sets HTTP status code
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equivalent
ok 46 - Error instance sets HTTP status code # time=1.514ms

# Subtest: Error status code below 400 defaults to 500
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equivalent
ok 47 - Error status code below 400 defaults to 500 # time=1.193ms

# Subtest: Error.status property support
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equivalent
ok 48 - Error.status property support # time=1.116ms

# Subtest: Support rejection with values that are not Error instances
    1..11
    # Subtest: Type: number
        1..4
        ok 1 - should be equal
        ok 2 - should not error
        ok 3 - should be equal
        ok 4 - should be equal
    ok 1 - Type: number # time=9.91ms
    
    # Subtest: Type: string
        1..4
        ok 1 - should be equal
        ok 2 - should not error
        ok 3 - should be equal
        ok 4 - should be equal
    ok 2 - Type: string # time=9.078ms
    
    # Subtest: Type: object
        1..4
        ok 1 - should be equivalent
        ok 2 - should not error
        ok 3 - should be equal
        ok 4 - should be equal
    ok 3 - Type: object # time=1.269ms
    
    # Subtest: Type: object
        1..4
        ok 1 - should be equivalent
        ok 2 - should not error
        ok 3 - should be equal
        ok 4 - should be equal
    ok 4 - Type: object # time=2.187ms
    
    # Subtest: Type: object
        1..4
        ok 1 - should be equivalent
        ok 2 - should not error
        ok 3 - should be equal
        ok 4 - should be equal
    ok 5 - Type: object # time=9.779ms
    
    # Subtest: Type: undefined
        1..4
        ok 1 - should be equal
        ok 2 - should not error
        ok 3 - should be equal
        ok 4 - should be equal
    ok 6 - Type: undefined # time=2.237ms
    
    # Subtest: Type: number
        1..4
        ok 1 - should be equal
        ok 2 - should not error
        ok 3 - should be equal
        ok 4 - should be equal
    ok 7 - Type: number # time=1.181ms
    
    # Subtest: Type: string
        1..4
        ok 1 - should be equal
        ok 2 - should not error
        ok 3 - should be equal
        ok 4 - should be equal
    ok 8 - Type: string # time=1.192ms
    
    # Subtest: Type: object
        1..4
        ok 1 - should be equivalent
        ok 2 - should not error
        ok 3 - should be equal
        ok 4 - should be equal
    ok 9 - Type: object # time=1.01ms
    
    # Subtest: Type: object
        1..4
        ok 1 - should be equivalent
        ok 2 - should not error
        ok 3 - should be equal
        ok 4 - should be equal
    ok 10 - Type: object # time=1.05ms
    
    # Subtest: Type: object
        1..4
        ok 1 - should be equivalent
        ok 2 - should not error
        ok 3 - should be equal
        ok 4 - should be equal
    ok 11 - Type: object # time=1.017ms
    
ok 49 - Support rejection with values that are not Error instances # time=55.378ms

# Subtest: invalid schema - ajv
    1..4
    ok 1 - should be equal
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should be equal
ok 50 - invalid schema - ajv # time=22.858ms

# Subtest: should set the status code and the headers from the error object (from route handler) (no custom error handler)
    1..4
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 51 - should set the status code and the headers from the error object (from route handler) (no custom error handler) # time=1.55ms

# Subtest: should set the status code and the headers from the error object (from custom error handler)
    1..6
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should not error
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should be equivalent
ok 52 - should set the status code and the headers from the error object (from custom error handler) # time=4.481ms

# Subtest: '*' should throw an error due to serializer can not handle the payload type
    1..3
    ok 1 - type is TypeError
    ok 2 - should be equal
    ok 3 - should be equal
ok 53 - '*' should throw an error due to serializer can not handle the payload type # time=1.469ms

# Subtest: should throw an error if the custom serializer does not serialize the payload to a valid type
    1..3
    ok 1 - type is TypeError
    ok 2 - should be equal
    ok 3 - should be equal
ok 54 - should throw an error if the custom serializer does not serialize the payload to a valid type # time=1.601ms

# Subtest: should not set headers or status code for custom error handler
    1..7
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should not error
    ok 4 - should be equal
    ok 5 - should be equal
    ok 6 - should be equal
    ok 7 - should be equivalent
ok 55 - should not set headers or status code for custom error handler # time=1.369ms

# Subtest: error thrown by custom error handler routes to default error handler
    1..6
    ok 1 - should be equal
    ok 2 - should be equal
    ok 3 - should be equivalent
    ok 4 - should not error
    ok 5 - should be equal
    ok 6 - should be equivalent
ok 56 - error thrown by custom error handler routes to default error handler # time=1.337ms

# Subtest: allow re-thrown error to default error handler when route handler is async and error handler is sync
    1..4
    ok 1 - should be equal
    ok 2 - should not error
    ok 3 - should be equal
    ok 4 - should be equivalent
ok 57 - allow re-thrown error to default error handler when route handler is async and error handler is sync # time=1.247ms

# Subtest: should throw error if error code is undefined
    1..2
    ok 1 - should be equal
    ok 2 - should be equal
ok 58 - should throw error if error code is undefined # time=1.151ms

# Subtest: should throw error if error code is null
    1..2
    ok 1 - should be equal
    ok 2 - should be equal
ok 59 - should throw error if error code is null # time=3.869ms

# Subtest: should throw error if error code is error_code
    1..2
    ok 1 - should be equal
    ok 2 - should be equal
ok 60 - should throw error if error code is error_code # time=0.947ms

# Subtest: should throw error if error code is 0
    1..2
    ok 1 - should be equal
    ok 2 - should be equal
ok 61 - should throw error if error code is 0 # time=2.248ms

# Subtest: should throw error if error code is 1
    1..2
    ok 1 - should be equal
    ok 2 - should be equal
ok 62 - should throw error if error code is 1 # time=1.277ms

# Subtest: should throw error if error code is 99
    1..2
    ok 1 - should be equal
    ok 2 - should be equal
ok 63 - should throw error if error code is 99 # time=1.013ms

# Subtest: should throw error if error code is 600
    1..2
    ok 1 - should be equal
    ok 2 - should be equal
ok 64 - should throw error if error code is 600 # time=0.849ms

# Subtest: should throw error if error code is 700
    1..2
    ok 1 - should be equal
    ok 2 - should be equal
ok 65 - should throw error if error code is 700 # time=0.862ms

# Subtest: error handler is triggered when a string is thrown from sync handler
    1..3
    ok 1 - should be equal
    ok 2 - should not error
    ok 3 - should be equal
ok 66 - error handler is triggered when a string is thrown from sync handler # time=1.071ms

# Subtest: status code should be set to 500 and return an error json payload if route handler throws any non Error object expression
    1..2
    ok 1 - should be equal
    ok 2 - should be equal
ok 67 - status code should be set to 500 and return an error json payload if route handler throws any non Error object expression # time=1.72ms

# Subtest: should preserve the status code set by the user if an expression is thrown in a sync route
    1..2
    ok 1 - should be equal
    ok 2 - should be equal
ok 68 - should preserve the status code set by the user if an expression is thrown in a sync route # time=3.189ms

# Subtest: should trigger error handlers if a sync route throws any non-error object
    1..2
    ok 1 - should be equal
    ok 2 - should be equal
ok 69 - should trigger error handlers if a sync route throws any non-error object # time=1.118ms

# Subtest: should trigger error handlers if a sync route throws undefined
    1..1
    ok 1 - should be equal
ok 70 - should trigger error handlers if a sync route throws undefined # time=1.075ms

# Subtest: setting content-type on reply object should not hang the server case 1
    1..2
    ok 1 - should not error
    ok 2 - should be equal
ok 71 - setting content-type on reply object should not hang the server case 1 # time=1.078ms

# Subtest: setting content-type on reply object should not hang the server case 2
    1..1
    ok 1 - should be equivalent
ok 72 - setting content-type on reply object should not hang the server case 2 # time=1.261ms

# Subtest: setting content-type on reply object should not hang the server case 3
    1..2
    ok 1 - should not error
    ok 2 - should be equal
ok 73 - setting content-type on reply object should not hang the server case 3 # time=1.184ms

# Subtest: pipe stream inside error handler should not cause error
    1..3
    ok 1 - should not error
    ok 2 - should be equal
    ok 3 - should be equivalent
ok 74 - pipe stream inside error handler should not cause error # time=6.625ms

1..74
